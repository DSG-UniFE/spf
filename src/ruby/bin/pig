#!/usr/bin/env ruby

if RUBY_PLATFORM =~ /java/
  opencv_jar = '/usr/share/java/opencv.jar'
  $CLASSPATH << opencv_jar unless $CLASSPATH.include?(opencv_jar)
  JARS_DIR = File.expand_path(File.join(File.dirname(__FILE__), '..', '..', '..', 'jars'))
  Dir["#{JARS_DIR}/*.jar"].each do |jar|
    $CLASSPATH << jar unless $CLASSPATH.include?(jar)
  end
end

$TESSDATA_PREFIX = File.expand_path(File.join(File.dirname(__FILE__), '..', '..', '..', 'resources'))

SRC_RUBY_DIR = File.expand_path(File.join(File.dirname(__FILE__), '..'))
$LOAD_PATH.unshift(SRC_RUBY_DIR) unless $LOAD_PATH.include?(SRC_RUBY_DIR)

require 'java'
require 'concurrent'

require 'spf/gateway/pig'
require 'spf/common/extensions/thread_reporter'


puts "\n"
puts "++++++++++++++++++++++++++++++++++++"
puts "+++++                          +++++"
puts "+++++                          +++++"
puts "+++++           PIG            +++++"
puts "+++++ Programmable Iot Gateway +++++"
puts "+++++                          +++++"
puts "+++++                          +++++"
puts "++++++++++++++++++++++++++++++++++++"
puts "\n"

# Start the PIG --> Starts Data Listener & Configuration Agent threads
pig = SPF::Gateway::PIG.new().run
